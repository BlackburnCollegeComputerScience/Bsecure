\section{Design and Implementation}
This is a placeholder for an introductory paragraph to our design. Perhaps include a storyboard or something similar to illustrate the basic flow of the application
from the point of view of a user.

\subsection{Key Exchange}
One of the more critical aspects of information security is keeping the private data secret.
The short range of Bluetooth allows for a face-to-face exchange of information that significantly
 reduces the chances of interception. Furthermore utilizing the Diffie-Hellman Key Exchange protocol
ensures that attackers cannot use intercepted public data to recreate keys. This section explains
our implementation of these systems.

\subsubsection{Bluetooth Key Generation}
Explain Bluetooth sockets

Explain Bluetooth Client/Server delegation

Explain Diffie-Hellman generation using Java provided classes and objects

\subsubsection{Key Specifics}
The keys are Diffie-Hellman key exchange generated 32-byte secret numbers that are shared between
the two devices. Our application uses the bytes of this 32-byte number as the key for our block cipher.

The cipher implemented is an AES-256 cipher in CBC mode. This cipher handles encryption and
decryption of the text messages. The initialization vector is a randomly generated 128-bit block that
is shared over Bluetooth alongside the keys during exchange.

\subsection{Information Storage and Control}
This is a placeholder for a short paragraph or two that provides an overview of our Information Storage and Control systems.

\subsubsection{BSecure Databases}
To organize key usage to be synchronized between both devices we utilized sequence numbers.
These sequence numbers were sequential integer values associated with each key that represented the
order in which the key would be used. The next key to be used would be determined by incrementing the sequence
number of the previous key.

Explain the sequence number idea (Consumer/Producer control scheme for storage)

Explain key expiration (Each time key is ``used,'' a value is decremented)

Explain how we use the Android Contact\_ID (The primary key of the Android contact DB)

We stored all our important values for maintaining each BSecure associated contact
into a database. The values stored in this database table are used to decide what key to use for that
contact.

Refer to Table \ref{table:contacttable} for the row layout of our SQL database.

\begin{table*}
\centering
\caption{Key Table Design}
\label{table:contacttable}
\begin{tabular}{|c|c|c|c|} \hline
CONTACT\_ID&CURRENT\_SEQUENCE\_NUM&KEY&IV\\ \hline\end{tabular}
\end{table*}

\begin{table*}
\centering
\caption{Contact Table Design}
\label{table:contacttable}
\begin{tabular}{|c|c|c|c|c|c|} \hline
CONTACT\_ID&CURRENT\_SEQUENCE\_NUM&MAX\_SEQUENCE\_NUM&TOTAL\_KEYS&USES\_LEFT&USES\_MAX\\ \hline\end{tabular}
\end{table*}


\subsubsection{User Settings}
Elaborate on settings available to the user

Option to force a current key for a contact to expire

Option to force all keys with a contact to expire

Option to force all keys to expire with all contacts

If the user lacks keys with a contact they can still send unencrypted messages

User chooses a maximum and minimum number of times a key is to be used. During Bluetooth exchange
these values are sent to the other device and a decision is made on which mutual value to use for the maximum key use setting.

\subsection{Use of Text Message Headers}
This is a placeholder for an introductory paragraph on using headers in our text messages.

\subsubsection{BSecure Message Header}
Explain the use of a header in the text message to indicate that the message is from a BSecure application

We appended a header to the beginning of encrypted text messages to flag to the receiving application that
the incomming message is a BSecure encrypted message.

\subsubsection{Expire Current Key Header}
Explain the use of a header to notify that the contact has expired their key early (So keys remain synchronized across both devices).

\subsubsection{Expire All Keys Header}
Explain the use of a header to notify that the contact has expired ALL keys early.


